from django.db import models
class Product(models.Model):
    nome = models.CharField(max_length=120)
    sku = models.CharField(max_length=60, unique=True, blank=True)
    unidade = models.CharField(max_length=10, default='UN')
    preco_venda = models.DecimalField(max_digits=12, decimal_places=2, default=0)
    custo = models.DecimalField(max_digits=12, decimal_places=2, default=0)
    ativo = models.BooleanField(default=True)
    @property
    def estoque_atual(self):
        from inventory.models import StockMovement
        from django.db.models import Sum
        return StockMovement.objects.filter(produto=self).aggregate(q=Sum('quantidade'))['q'] or 0
    def __str__(self): return self.nome
